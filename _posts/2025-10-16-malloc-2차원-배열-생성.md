---
layout: post
title: "malloc, 2차원 배열 생성"
date: 2025-10-01
categories: [general]
tags: [C]
excerpt_separator: ""
---



### **이 코드 이해하기**


```c
int **res = (int **)malloc(sizeof(int*) * rows);
```

1. `sizeof(int*)`

    : `int*` 타입의 크기 : 8바이트

2. `malloc()`

    : 동적 메모리 할당 시 사용


    > 💡 **정적 메모리** : `int arr[10]` - 컴파일 시 크기 고정  
    > **동적 메모리** : 실행 중에 필요한 만큼 할당

3. `malloc(sizeof(int*) * rows)`

    : 8바이트 곱하기 `rows`


    → int* 타입의 변수를 rows개 담을 수 있는 공간 생성(메모리 할당)

4. `(int **)malloc(sizeof(int*) * rows)`

    : `int**` 타입으로 형변환


    **하는 이유는?**


    → 기본적으로 `malloc`은 `void*` 타입을 반환하므로 형변환을 하지 않으면 배열 접근이 불가능


    ```c
    // 예시
    // 형변환 하지 않은 경우
    void* temp = malloc(sizeof(int*) * rows);
    // temp[0] = ... 등으로 접근 불가능
    
    // 형변환 한 경우
    int** res = (int**)malloc(sizeof(int*) * rows);
    // res[0] = ... int* 배열로 접근 가능
    ```


### **결론**


주로 2차원 배열, 포인터 배열을 만들기 전에 준비하는 과정에서 사용될 수 있다.


```c
// 이런식으로 2차원 배열 생성 가능
for(int i = 0; i < rows; i++)
    res[i] = (int *)malloc(sizeof(int) * cols);
}
```


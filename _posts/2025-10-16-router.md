---
layout: post
title: "Router"
date: 2023-02-01
categories: [general]
tags: [React]
---


# _Routing 이란 ?_


: 사용자가 요청한 URL 에 따라 알맞은 페이지를 보여주는 것


: 여러 페이지로 구성된 웹 어플리케이션을 만들 때 페이지 별로 컴포넌트들을 분리해가면서 프로젝트를 관리하기 위해 필요한 것


### ✔️ 라우트 시스템 구축을 위해 사용할 수 있는 선택지


1 ) **리액트 라우터** : 가장 오래됐고, 가장 많이 사용됨 / 컴포넌트 기반으로 라우팅 시스템을 설정할 수 있음


2 ) **Next.js** : 리액트 프로젝트의 프레임워크 / 파일 경로 기반으로 작동 / 프로젝트 설정, 라우팅 시스템, 최적화, 다국어 시스템 지언, 서버 사이드 렌더링 등 다양한 기능 제공


3 ) 그 외 : react-location, rakkas


# _single page application 이란 ?_


: 하나의 페이지로 이루어진 어플리케이션


: html 은 한번만 받아와서 웹 어플리케이션을 실행시킨 후 이후에는 필요한 데이터만 받아와서 화면에 업데이트 하는 것


: 라우팅 시스템은 다른 페이지로 이동할 때 브라우저의 History API 를 사용하여 주소창의 값만 변경하고 기존에 페이지에 띄웠던 웹 어플리케이션을 그대로 유지하며 라우팅 설정에 따라 또다른 페이지를 보여주게 됨


: 리액트 같은 라이브러리를 사용하여 뷰 렌더링을 사용자의 브라우저가 담당하도록 하고 우선 웹 어플리케이션을 브라우저에 불러와서 실행시킨 후에 사용자와의 인터랙션이 발생하면 필요한 부분만 자바스크립트를 사용하여 업데이트 하는 방식을 사용하게 됨 / 만약 새로운 데이터가 필요하다면 서버 API 를 호출하여 필요한 데이터만 새로 불러와 어플리케이션에서 사용할 수 있게 된 것


# _BrowserRouter_


: 이 컴포넌트는 웹 어플리케이션에 HTML5의 History API 를 사용하여 페이지를 새로 불러오지 않고도 주소를 변경하고 현재 주소의 경로에 관련된 정보를 리액트 컴포넌트에서 사용할 수 있도록 해줌


: src/index.js 파일에서 react-router-dom 에 내장되어 있음


: 리액트 라우터를 적용할 때는 이 컴포넌트를 사용하여 감싸면 됨 like this 👇🏻


```javascript
import React from "react";
import ReactDOM from "react-dom/client";
import "./index.css";
import App from "./App";
import reportWebVitals from "./reportWebVitals";
import { BrowserRouter } from "react-router-dom";

const root = ReactDOM.createRoot(document.getElementById("root"));
root.render(
  <BrowserRouter>
    <App />
  </BrowserRouter>
);
reportWebVitals();
```


# _Route_


: 사용자의 브라우저 주소 경로에 따라 우리가 원하는 컴포넌트를 보여주려면 이 컴포넌트를 통해 라우트 설정을 해주어야 함 / Routes 컴포넌트 내부에서 사용되어야 함


### ✔️ 문법


> 💡 `<Route path=”주소규칙” element={보여 줄 컴포넌트 JSX}/>`


# _Link_


: 리액트 라우터를 사용하는 프로젝트에서는 a 태그를 사용하면 안됨 / a 태그를 클릭하여 페이지를 이동할 때 브라우저에서는 페이지를 새로 불러오게 되기 때문


: link 컴포넌트 역시 a 태그를 사용하긴 하지만 페이지를 새로 불러오는 것을 막고 History API 를 통해 브라우저 주소의 경로를 바꾸는 기능이 내장되어 있음


### ✔️ 문법


> 💡 `<Link to=”경로”>링크 이름</Link>`


# _Url 파라미터_


: 주소의 경로에 유동적인 값을 넣는 형태 / ID 또는 이름을 사용하여 특정 데이터를 조회할 때 사용


### 🌈 예시


> 💡 `/profile/velopert`


# _useParams_


: URL 파라미터를 객체 형태로 조회 가능


: URL 파라미터의 이름은 라우트 설정을 할 때 Route 컴포넌트의 path props 를 통해 설정


```javascript
import React from "react";
import { useParams } from "react-router-dom";

const data = {
  velopert: {
    name: "김민준",
    description: "리액트를 좋아하는 개발자",
  },
  gildong: {
    name: "홍길동",
    description: "고전 소설 홍길동의 주인공",
  },
};
const Profile = () => {
  const params = useParams();
  const profile = data[params.username];
  return (
    <div>
      <h1>사용자 프로필</h1>
      {profile ? (
        <div>
          <h2>{profile.name}</h2>
          <p>{profile.description}</p>
        </div>
      ) : (
        <p>존재하지 않는 프로필 입니다.</p>
      )}
    </div>
  );
};

export default Profile;
```


🌀 data 객체에 예시 프로필 정보를 key-value 형태로 담아둠 /  Profile 컴포넌트에서는 username URL 파라미터를 통해 프로필을 조회한 뒤에 삼항조건연산자로 보여줄 것 정하게


```javascript
import React from "react";
import { Route, Routes } from "react-router-dom";
import About from "./pages/About";
import Home from "./pages/Home";
import Profile from "./pages/Profile";

const App = () => {
  return (
    <Routes>
      <Route path="/" element={<Home />} />
      <Route path="/about" element={<About />} />
      <Route path="/profiles/:username" element={<Profile />} />
    </Routes>
  );
};

export default App;
```


🌀 URL 파라미터는 경로에 : 를 사용하여 설정 


🌀 여러개라면 /profiles/:username/:field 와 같이 설정할 수 있음


```javascript
import React from "react";
import { Link } from "react-router-dom";

const Home = () => {
  return (
    <div>
      <h1>홈</h1>
      <p>가장 먼저 보여지는 페이지 입니다.</p>
      <Link to="/about">소개</Link>
      <Link to="/profiles">프로필</Link>
      <Link to="/profiles/velopert">velopert 의 프로필</Link>
      <Link to="/profiles/gildong">gildong 의 프로필</Link>
      <Link to="/profiles/void">존재하지 않는 프로필</Link>
    </div>
  );
};

export default Home;
```


🌀 link 태그 추가


# _쿼리스트링_


: 주소의 뒷부분에 ? 문자열 이후에 key=value 로 값을 정의하며 &로 구분하는 형태 / 키워드 검색, 페이지네이션, 정렬 방식 등 데이터 조회에 필요한 옵션을 전달할 때 사용


### 🌈 예시


> 💡 `/articles?page=1&keyword=react`


# _useLocation_


: location 객체를 반환 / 이 객체는 현재 사용자가 보고 있는 페이지의 정보를 지니고 있음


### ✔️ location 객체에는 ?


- **pathname** : 현재 주소의 경로 (쿼리스트링 제외)


- **search** : 맨 앞의 ? 문자를 포함한 쿼리스트링 값


- **hash** : 주소의 # 문자열 뒤의 값 (주로 History API 가 지원되지 않는 구형 브라우저에서 클라이언트 라우팅을 사용할 때 쓰는 해시 라우터에 사용)


- **state** : 페이지로 이동할 때 임의로 넣을 수 있는 상태값


- **key** : location 객체의 고유값, 초기에는 default 이며 페이지가 변경될 때마다 고유의 값이 생성됨


# _useSearchParams_


: 쿼리스트링을 파싱하는 Hook


: 배열 타입의 값을 반환 / 첫 번째 원소는 쿼리파라미터를 조회하거나 수정하는 메서드들이 담긴 객체를 반환 / get 메서드를 통해 특정 쿼리파라미터를 업데이트 할 수 있음 만약 조회 시 쿼리파라미터가 존재하지 않는다면 null 로 조회됨 / 두 번째 원소는 쿼리파라미터를 객체 형태로 업데이트 할 수 있는 함수를 반환함


```javascript
import React from "react";
import { useSearchParams } from "react-router-dom";

const About = () => {
  const [searchParams, setSearchParams] = useSearchParams();
  const detail = searchParams.get("detail");
  const mode = searchParams.get("mode");

  const onToggleDetail = () => {
    setSearchParams({ mode, detail: detail === "true" ? false : true });
  };
  const onIncreaseMode = () => {
    const nextMode = mode === null ? 1 : parseInt(mode) + 1;
    setSearchParams({ mode: nextMode, detail });
  };
  return (
    <div>
      <h1>소개</h1>
      <p>리액트 라우터를 사용해 보는 프로젝트입니다.</p>
      <p>detail : {detail}</p>
      <p>mode : {mode}</p>
      <button onClick={onToggleDetail}>Toggle detail</button>
      <button onClick={onIncreaseMode}>mode +1</button>
    </div>
  );
};

export default About;
```


🌀 쿼리파라미터를 조회할 때 값은 무조건 문자열 타입임 / true false 값을 넣는다면 값을 비교할 때 꼭 true 와 같이 ‘’로 감싸서 비교해야하고, 숫자를 다룬다면 parseInt 를 사용하여 숫자 타입으로 변환을 해야함


```javascript
import React from "react";
import { Route, Routes } from "react-router-dom";
import About from "./pages/About";
import Article from "./pages/Article";
import Articles from "./pages/Articles";
import Home from "./pages/Home";
import Profile from "./pages/Profile";

const App = () => {
  return (
    <Routes>
      <Route path="/" element={<Home />} />
      <Route path="/about" element={<About />} />
      <Route path="/profiles/:username" element={<Profile />} />
      <Route path="/profiles" element={<Profile />} />
      <Route path="/articles" element={<Articles />} />
      <Route path="/articles/:id" element={<Article />} />
    </Routes>
  );
};

export default App;
```


🌀 App 에서 :id 로 가라고 하고


```javascript
import React from "react";
import { Link } from "react-router-dom";

const Home = () => {
  return (
    <div>
      <h1>홈</h1>
      <p>가장 먼저 보여지는 페이지 입니다.</p>
      <Link to="/about">소개</Link>
      <Link to="/profiles">프로필</Link>
      <Link to="/profiles/velopert">velopert 의 프로필</Link>
      <Link to="/profiles/gildong">gildong 의 프로필</Link>
      <Link to="/profiles/void">존재하지 않는 프로필</Link>
      <Link to="/articles">게시글 목록</Link>
    </div>
  );
};

export default Home;
```


🌀 Home 에서 articles 로 가라고 하고


```javascript
import React from "react";
import { Link } from "react-router-dom";

const Articles = () => {
  return (
    <ul>
      <li>
        <Link to="/articles/1">게시글 1</Link>
      </li>
      <li>
        <Link to="/articles/2">게시글 2</Link>
      </li>
      <li>
        <Link to="/articles/3">게시글 3</Link>
      </li>
    </ul>
  );
};

export default Articles;
```


🌀 Articles 에서 123 으로 가라고 하는데 그게 id 고


```javascript
import { useParams } from "react-router-dom";

import React from "react";

const Article = () => {
  const { id } = useParams();
  return (
    <div>
      <h2>게시글{id}</h2>
    </div>
  );
};

export default Article;
```


🌀 article 에서 id 를 params 로 쓴다고 하고 / 그 id 는 App 의 Route component 의 path props 를 통해 설정된 이름


# _outlet_


: Route 의 children 으로 들어가는 JSX 엘리먼트를 보여주는 역할을 함


: 모든 페이지 상단에 heather 를 보여줘야 하는 상황에 이걸 사용하면 좋다 !


```javascript
import React from "react";
import { Route, Routes } from "react-router-dom";
import About from "./pages/About";
import Article from "./pages/Article";
import Articles from "./pages/Articles";
import Home from "./pages/Home";
import Profile from "./pages/Profile";

const App = () => {
  return (
    <Routes>
      <Route path="/" element={<Home />} />
      <Route path="/about" element={<About />} />
      <Route path="/profiles/:username" element={<Profile />} />
      <Route path="/profiles" element={<Profile />} />
      <Route path="/articles" element={<Articles />}>
        <Route path=":id" element={<Article />} />
      </Route>
    </Routes>
  );
};

export default App;
```


🌀 중첩된 라우트 형태로 라우트를 설정


```javascript
import React from "react";
import { Link, Outlet } from "react-router-dom";

const Articles = () => {
  return (
    <div>
      <Outlet />
      <ul>
        <li>
          <Link to="/articles/1">게시글 1</Link>
        </li>
        <li>
          <Link to="/articles/2">게시글 2</Link>
        </li>
        <li>
          <Link to="/articles/3">게시글 3</Link>
        </li>
      </ul>
    </div>
  );
};

export default Articles;
```


🌀 Outlet 컴포넌트가 사용된 자리에 중첩된 라우트가 보여지게 됩니다 그렇네요


```javascript
import React from "react";
import { Outlet } from "react-router-dom";

const Layout = () => {
  return (
    <div>
      <header style={{ background: "lightgray", padding: 16, fontSize: 24 }}>
        Header
      </header>
      <main>
        <Outlet />
      </main>
    </div>
  );
};

export default Layout;
```


```javascript
import React from "react";
import { Route, Routes } from "react-router-dom";
import About from "./pages/About";
import Article from "./pages/Article";
import Articles from "./pages/Articles";
import Home from "./pages/Home";
import Profile from "./pages/Profile";
import Layout from "./Layout";

const App = () => {
  return (
    <Routes>
      <Route element={<Layout />}>
        <Route path="/" element={<Home />} />
        <Route path="/about" element={<About />} />
        <Route path="/profiles/:username" element={<Profile />} />
      </Route>
      <Route path="/articles" element={<Articles />}>
        <Route path=":id" element={<Article />} />
      </Route>
    </Routes>
  );
};

export default App;
```


🌀 공통된 header 쉽게 만들기 > header 만들어주고 각 페이지 컴포넌트가 보여야 하는 곳에 outlet > app 에서 route 로 감싸주기


```javascript
<Route index element={<Home />} />
```


🌀 index = path=”/” / index props 를 사용하면 상위 라우트의 경로와 일치하지만 그 이후에 경로가 주어지지 않았을 때 보여지는 라우트를 설정할 수 있음 / 좀 더 명시적으로 표현하는 방법

